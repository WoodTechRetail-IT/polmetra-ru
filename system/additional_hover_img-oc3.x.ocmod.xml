<modification>
	<name>Additional hover images</name>
	<code>additional_hover_images_oc3.x</code>
	<version>1.0</version>
	<author>bigeon.ru</author>
	<link>https://bigeon.ru</link>

    <file path="catalog/controller/product/{category,manufacturer,search,special}.php">
        <operation>
            <search><![CDATA[$data['products'][] = array(]]></search>
            <add position="before"><![CDATA[				
                $results_img = $this->model_catalog_product->getProductImages($result['product_id']);
                $additional_img = array();
                foreach ($results_img as $result_img) {
                    if ($result_img['image']) {
                        $additional_image = $this->model_tool_image->resize($result_img['image'], $this->config->get('theme_' . $this->config->get('config_theme') . '_image_product_width'), $this->config->get('theme_' . $this->config->get('config_theme') . '_image_product_height'));
                    } else {
                        $additional_image = false;
                    }
                    $additional_img[] = $additional_image;
                }
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['products'][] = array(]]></search>
            <add position="after"><![CDATA[
                'additional_img' => $additional_img,
            ]]></add>
        </operation>
    </file>

    <file path="catalog/controller/product/product.php">
        <operation>
            <search><![CDATA[$this->config->get('theme_' . $this->config->get('config_theme') . '_image_product_width'), $this->config->get('theme_' . $this->config->get('config_theme') . '_image_product_height'));]]></search>
            <add position="replace"><![CDATA[
                $this->config->get('theme_' . $this->config->get('config_theme') . '_image_related_width'), $this->config->get('theme_' . $this->config->get('config_theme') . '_image_related_height'));
            ]]></add>
        </operation>
    </file>

    <file path="catalog/view/theme/*/template/product/{category,manufacturer_info,search,special}.twig">
        <operation>
            <search><![CDATA[<img src="{{ product.thumb }}" alt="{{ product.name }}" title="{{ product.name }}" class="img-responsive" />]]></search>
            <add position="after"><![CDATA[
                {% for additional_img in product.additional_img|slice(0, 4) %}
                <img src="{{ additional_img }}" class="img-responsive" style="display: none;" />
                {% endfor %}
            ]]></add>
        </operation>
    </file>

    <file path="catalog/view/theme/*/template/extension/{bestseller,featured,latest,special}.twig">
        <operation>
            <search><![CDATA[<img src="{{ product.thumb }}" alt="{{ product.name }}" title="{{ product.name }}" class="img-responsive" />]]></search>
            <add position="after"><![CDATA[
                {% for additional_img in product.additional_img|slice(0, 4) %}
                <img src="{{ additional_img }}" class="img-responsive" style="display: none;" />
                {% endfor %}
            ]]></add>
        </operation>
    </file>

    <file path="catalog/controller/extension/module/featured.php">
        <operation>
            <search><![CDATA[$data['products'][] = array(]]></search>
            <add position="before"><![CDATA[					
                $results_img = $this->model_catalog_product->getProductImages($product_info['product_id']);
                $additional_img = array();
                foreach ($results_img as $result_img) {
                    if ($result_img['image']) {
                        $additional_image = $this->model_tool_image->resize($result_img['image'], $setting['width'], $setting['height']);
                    } else {
                        $additional_image = false;
                    }
                    $additional_img[] = $additional_image;
                }
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['products'][] = array(]]></search>
            <add position="after"><![CDATA[
                'additional_img' => $additional_img,
            ]]></add>
        </operation>
    </file>

    <file path="catalog/controller/extension/module/{bestseller,latest,special}.php">
        <operation>
            <search><![CDATA[$data['products'][] = array(]]></search>
            <add position="before"><![CDATA[				
                $results_img = $this->model_catalog_product->getProductImages($result['product_id']);
                $additional_img = array();
                foreach ($results_img as $result_img) {
                    if ($result_img['image']) {
                        $additional_image = $this->model_tool_image->resize($result_img['image'], $setting['width'], $setting['height']);
                    } else {
                        $additional_image = false;
                    }
                    $additional_img[] = $additional_image;
                }
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['products'][] = array(]]></search>
            <add position="after"><![CDATA[
                'additional_img' => $additional_img,
            ]]></add>
        </operation>
    </file>

    <file path="catalog/view/theme/*/template/extension/module/{bestseller,featured,latest,special}.twig">
        <operation>
            <search><![CDATA[<img src="{{ product.thumb }}" alt="{{ product.name }}" title="{{ product.name }}" class="img-responsive" />]]></search>
            <add position="after"><![CDATA[
                {% for additional_img in product.additional_img|slice(0, 4) %}
                <img src="{{ additional_img }}" class="img-responsive" style="display: none;" />
                {% endfor %}
            ]]></add>
        </operation>
    </file>

    <file path="catalog/view/theme/*/template/common/footer.twig">
        <operation>
            <search><![CDATA[</body>]]></search>
            <add position="before"><![CDATA[
                <link href="catalog/view/javascript/hover-img-additional/jquery.hover-carousel.css" rel="stylesheet">
                <script src="catalog/view/javascript/hover-img-additional/jquery.hover-carousel.js"></script>
                <script>$(document).ready(function() {$(".product-item__image>a").HoverMouseCarousel();});</script>
            ]]></add>
        </operation>
    </file>

</modification>